<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>DSpace Documentation : Submission User Interface</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            DSpace Documentation : Submission User Interface
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 15, 2010 by <font color="#0050B2">tdonohue</font>.
				    </div>

				    <h1><a name="SubmissionUserInterface-DSpaceSystemDocumentation%3ACustomizingandConfiguringSubmissionUserInterface"></a>DSpace System Documentation: Customizing and Configuring Submission User Interface</h1>

<p>This page explains various customization and configuration options that are available within DSpace for the Item Submission user interface.</p>

<style type='text/css'>/*<![CDATA[*/
div.rbtoc1292437768892 {margin-left: 0px;padding: 0px;}
div.rbtoc1292437768892 ul {list-style: none;margin-left: 0px;}
div.rbtoc1292437768892 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1292437768892'>
<ul>
    <li><span class='TOCOutline'>1</span> <a href='#SubmissionUserInterface-UnderstandingtheSubmissionConfigurationFile'>Understanding the Submission Configuration File</a></li>
<ul>
    <li><span class='TOCOutline'>1.1</span> <a href='#SubmissionUserInterface-TheStructureofitemsubmission.xml'>The Structure of <em>item-submission.xml</em></a></li>
    <li><span class='TOCOutline'>1.2</span> <a href='#SubmissionUserInterface-DefiningSteps%28%3Cstep%3E%29withintheitemsubmission.xml'>Defining Steps ( <em>&lt;step&gt;</em>) within the <em>item-submission.xml</em></a></li>
<ul>
    <li><span class='TOCOutline'>1.2.1</span> <a href='#SubmissionUserInterface-Wheretoplaceyour%3Cstep%3Edefinitions'>Where to place your <em>&lt;step&gt;</em> definitions</a></li>
    <li><span class='TOCOutline'>1.2.2</span> <a href='#SubmissionUserInterface-Theorderingof%3Cstep%3Edefinitionsmatters%5C%21'>The ordering of <em>&lt;step&gt;</em> definitions matters!</a></li>
    <li><span class='TOCOutline'>1.2.3</span> <a href='#SubmissionUserInterface-Structureofthe%3Cstep%3EDefinition'>Structure of the &lt;step&gt; Definition</a></li>
</ul>
</ul>
    <li><span class='TOCOutline'>2</span> <a href='#SubmissionUserInterface-Reordering%2FRemovingSubmissionSteps'>Reordering/Removing Submission Steps</a></li>
    <li><span class='TOCOutline'>3</span> <a href='#SubmissionUserInterface-AssigningacustomSubmissionProcesstoaCollection'>Assigning a custom Submission Process to a Collection</a></li>
<ul>
    <li><span class='TOCOutline'>3.1</span> <a href='#SubmissionUserInterface-GettingACollection%27sHandle'>Getting A Collection's Handle</a></li>
</ul>
    <li><span class='TOCOutline'>4</span> <a href='#SubmissionUserInterface-CustomMetadataentryPagesforSubmission'>Custom Metadata-entry Pages for Submission</a></li>
<ul>
    <li><span class='TOCOutline'>4.1</span> <a href='#SubmissionUserInterface-Introduction'>Introduction</a></li>
    <li><span class='TOCOutline'>4.2</span> <a href='#SubmissionUserInterface-DescribingCustomMetadataForms'>Describing Custom Metadata Forms</a></li>
    <li><span class='TOCOutline'>4.3</span> <a href='#SubmissionUserInterface-TheStructureofinputforms.xml'>The Structure of <em>input-forms.xml</em></a></li>
<ul>
    <li><span class='TOCOutline'>4.3.1</span> <a href='#SubmissionUserInterface-AddingaCollectionMap'>Adding a Collection Map</a></li>
<ul>
    <li><span class='TOCOutline'>4.3.1.1</span> <a href='#SubmissionUserInterface-GettingACollection%27sHandle'>Getting A Collection's Handle</a></li>
</ul>
    <li><span class='TOCOutline'>4.3.2</span> <a href='#SubmissionUserInterface-AddingaFormSet'>Adding a Form Set</a></li>
<ul>
    <li><span class='TOCOutline'>4.3.2.1</span> <a href='#SubmissionUserInterface-FormsandPages'>Forms and Pages</a></li>
    <li><span class='TOCOutline'>4.3.2.2</span> <a href='#SubmissionUserInterface-CompositionofaField'>Composition of a Field</a></li>
    <li><span class='TOCOutline'>4.3.2.3</span> <a href='#SubmissionUserInterface-AutomaticallyElidedFields'>Automatically Elided Fields</a></li>
</ul>
    <li><span class='TOCOutline'>4.3.3</span> <a href='#SubmissionUserInterface-AddingValuePairs'>Adding Value-Pairs</a></li>
<ul>
    <li><span class='TOCOutline'>4.3.3.1</span> <a href='#SubmissionUserInterface-Example'>Example</a></li>
</ul>
</ul>
    <li><span class='TOCOutline'>4.4</span> <a href='#SubmissionUserInterface-DeployingYourCustomForms'>Deploying Your Custom Forms</a></li>
</ul>
    <li><span class='TOCOutline'>5</span> <a href='#SubmissionUserInterface-ConfiguringtheFileUploadstep'>Configuring the File Upload step</a></li>
    <li><span class='TOCOutline'>6</span> <a href='#SubmissionUserInterface-CreatingnewSubmissionSteps'>Creating new Submission Steps</a></li>
<ul>
    <li><span class='TOCOutline'>6.1</span> <a href='#SubmissionUserInterface-CreatingaNonInteractiveStep'>Creating a Non-Interactive Step</a></li>
</ul>
</ul></div>

<h2><a name="SubmissionUserInterface-UnderstandingtheSubmissionConfigurationFile"></a>Understanding the Submission Configuration File</h2>

<p>The <em>[dspace]/config/item-submission.xml</em> contains the submission configurations for <em>both</em> the DSpace JSP user interface (JSPUI) or the DSpace XML user interface (XMLUI or Manakin). This configuration file contains detailed documentation within the file itself, which should help you better understand how to best utilize it.</p>

<h3><a name="SubmissionUserInterface-TheStructureofitemsubmission.xml"></a>The Structure of <em>item-submission.xml</em></h3>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;item-submission&gt;
	&lt;!-- Where submission processes are mapped to specific Collections --&gt;
	&lt;submission-map&gt;
	&lt;name-map collection-handle=<span class="code-quote">"<span class="code-keyword">default</span>"</span> submission-name=<span class="code-quote">"traditional"</span> /&gt; ...
	&lt;/submission-map&gt;
	&lt;!-- Where <span class="code-quote">"steps"</span> which are used across many submission processes can be defined in a
	   single place. They can then be referred to by ID later. --&gt;
	&lt;step-definitions&gt;
	&lt;step id=<span class="code-quote">"collection"</span>&gt;
	&lt;processing-class&gt;org.dspace.submit.step.SelectCollectionStep&lt;/process;/processing-class&gt;
	&lt;workflow-editable&gt;<span class="code-keyword">false</span>&lt;/workflow-editable&gt;
	&lt;/step&gt;
		...
	&lt;/step-definitions&gt;
	&lt;!-- Where actual submission processes are defined and given names. Each &lt;submission-process&gt; has
	   many &lt;step&gt; nodes which are in the order that the steps should be in.--&gt;
	&lt;submission-definitions&gt; &lt;submission-process name=<span class="code-quote">"traditional"</span>&gt;
	    ...
	&lt;!-- Step definitions appear here! --&gt;
	&lt;/submission-process&gt;
	    ...
	&lt;/submission-definitions&gt;
	&lt;/item-submission&gt; </pre>
</div></div>
<p>Because this file is in XML format, you should be familiar with XML before editing this file. By default, this file contains the "traditional" Item Submission Process for DSpace, which consists of the following Steps (in this order):</p>

<p><em>Select Collection &#45;&gt; Initial Questions &#45;&gt; Describe &#45;&gt; Upload &#45;&gt; Verify &#45;&gt; License &#45;&gt; Complete</em></p>

<p>If you would like to customize the steps used or the ordering of the steps, you can do so within the <em>&lt;submission-definition&gt;</em> section of the <em>item-submission.xml</em> .</p>

<p>In addition, you may also specify different Submission Processes for different DSpace Collections. This can be done in the <em>&lt;submission-map&gt;</em> section. The <em>item-submission.xml</em> file itself documents the syntax required to perform these configuration changes.</p>


<h3><a name="SubmissionUserInterface-DefiningSteps%28%3Cstep%3E%29withintheitemsubmission.xml"></a>Defining Steps (<em>&lt;step&gt;</em>) within the <em>item-submission.xml</em></h3>

<p>This section describes how Steps of the Submission Process are defined within the <em>item-submission.xml</em>.</p>

<h4><a name="SubmissionUserInterface-Wheretoplaceyour%3Cstep%3Edefinitions"></a>Where to place your <em>&lt;step&gt;</em> definitions</h4>

<p><em>&lt;step&gt;</em> definitions can appear in one of two places within the <em>item-submission.xml</em> configuration file.</p>

<ol>
	<li>Within the <em>&lt;step-definitions&gt;</em> section
	<ul>
		<li>This is for globally defined <em>&lt;step&gt;</em> definitions (i.e. steps which are used in multiple <em>&lt;submission-process&gt;</em> definitions). Steps defined in this section <b>must</b> define a unique <em>id</em> which can be used to reference this step.</li>
		<li>For example: 
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;step-definitions&gt;
	&lt;step id=<span class="code-quote">"custom-step"</span>&gt;
	   ...
	&lt;/step&gt;
	  ...
&lt;/step-definitions&gt;</pre>
</div></div></li>
		<li>The above step definition could then be referenced from within a <em>&lt;submission-process&gt;</em> as simply <em>&lt;step id="custom-step"/&gt;</em></li>
	</ul>
	</li>
	<li>Within a specific <em>&lt;submission-process&gt;</em> definition
	<ul>
		<li>This is for steps which are specific to a single <em>&lt;submission-process&gt;</em> definition.</li>
		<li>For example:  
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;submission-process&gt;
	&lt;step&gt;
	   ...
	&lt;/step&gt;
&lt;/submission-process&gt;</pre>
</div></div></li>
	</ul>
	</li>
</ol>


<h4><a name="SubmissionUserInterface-Theorderingof%3Cstep%3Edefinitionsmatters%5C%21"></a>The ordering of <em>&lt;step&gt;</em> definitions matters&#33;</h4>

<p>The ordering of the <em>&lt;step&gt;</em> tags within a <em>&lt;submission-process&gt;</em> definition directly corresponds to the order in which those steps will appear&#33;</p>

<p>For example, the following defines a Submission Process where the <em>License</em> step directly precedes the <em>Initial Questions</em> step (more information about the structure of the information under each &lt;step&gt; tag can be found in the section on Structure of the &lt;step&gt; Definition below):</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;submission-process&gt;
	&lt;!--Step 1 will be to Sign off on the License--&gt;
	   &lt;step&gt;
	     &lt;heading&gt;submit.progressbar.license&lt;/heading&gt;
	     &lt;processing-class&gt;org.dspace.submit.step.LicenseStep&lt;/processing-classing-class&gt;
	     &lt;jspui-binding&gt;org.dspace.app.webui.submit.step.JSPLicenseStep&lt;/jspui-binding&gt;
	     &lt;xmlui-binding&gt;org.dspace.app.xmlui.aspect.submission.submit.LicenseStenseStep&lt;/xmlui-binding&gt;
	     &lt;workflow-editable&gt;<span class="code-keyword">false</span>&lt;/workflow-editable&gt;
	   &lt;/step&gt;
	&lt;!--Step 2 will be to Ask Initial Questions--&gt;
	&lt;step&gt;
	   &lt;heading&gt;submit.progressbar.initial-questions&lt;/heading&gt;
	      &lt;processing-class&gt;org.dspace.submit.step.InitialQuestionsStep&lt;/process;/processing-class&gt;
	      &lt;jspui-binding&gt;org.dspace.app.webui.submit.step.JSPInitialQuestionsSteonsStep&lt;/jspui-binding&gt;
	      &lt;xmlui-binding&gt;org.dspace.app.xmlui.aspect.submission.submit.InitialQutialQuestionsStep&lt;/xmlui-binding&gt;
	      &lt;workflow-editable&gt;<span class="code-keyword">true</span>&lt;/workflow-editable&gt;
	   &lt;/step&gt;
	      ...[other steps]...
&lt;/submission-process&gt; </pre>
</div></div>

<h4><a name="SubmissionUserInterface-Structureofthe%3Cstep%3EDefinition"></a>Structure of the &lt;step&gt; Definition</h4>

<p>The same &lt;step&gt; definition is used by both the DSpace JSP user interface (JSPUI) an the DSpace XML user interface (XMLUI or Manakin). Therefore, you will notice each &lt;step&gt; definition contains information specific to each of these two interfaces.</p>

<p>The structure of the &lt;step&gt; Definition is as follows:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;step&gt;
	&lt;heading&gt;submit.progressbar.describe&lt;/heading&gt;
	&lt;processing-class&gt;org.dspace.submit.step.DescribeStep&lt;/processing-classing-class&gt;
	&lt;jspui-binding&gt;org.dspace.app.webui.submit.step.JSPDescribeStep&lt;/jspuilt;/jspui-binding&gt;
	&lt;xmlui-binding&gt;org.dspace.app.xmlui.aspect.submission.submit.DescribeScribeStep&lt;/xmlui-binding&gt;
	&lt;workflow-editable&gt;<span class="code-keyword">true</span>&lt;/workflow-editable&gt;
&lt;/step&gt;</pre>
</div></div>
<p>Each <em>step</em> contains the following elements. The required elements are so marked:</p>

<ul>
	<li><b>heading</b>: Partial I18N key (defined in <em>Messages.properties</em> for JSPUI or <em>messages.xml</em> for XMLUI) which corresponds to the text that should be displayed in the submission Progress Bar for this step. This partial I18N key is prefixed within either the Messages.properties or messages.xml file, depending on the interface you are using. Therefore, to find the actual key, you will need to search for the partial key with the following prefix:
	<ul>
		<li>XMLUI: prefix is <em>xmlui.Submission.</em> (e.g. "xmlui.Submission.submit.progressbar.describe" for 'Describe' step)</li>
		<li>JSPUI: prefix is <em>jsp.</em> (e.g. "jsp.submit.progressbar.describe" for 'Describe' step)<em>The 'heading' need not be defined if the step should not appear in the progress bar (e.g. steps which perform automated processing, i.e. non-interactive, should not appear in the progress bar).</em></li>
	</ul>
	</li>
	<li><b>processing-class</b> (Required): Full Java path to the Processing Class for this Step. This Processing Class <b>must</b> perform the primary processing of any information gathered in this step, for both the XMLUI and JSPUI. All valid step processing classes must extend the abstract <tt>org.dspace.submit.AbstractProcessingStep</tt> class (or alternatively, extend one of the pre-existing step processing classes in <tt>org.dspace.submit.step.&#42;</tt>)</li>
	<li><b>jspui-binding</b>: Full Java path of the JSPUI "binding" class for this Step. This "binding" class should initialize and call the appropriate JSPs to display the step's user interface. A valid JSPUI "binding" class <em>must</em> extend the abstract <tt>org.dspace.app.webui.submit.JSPStep</tt> class. <em>This property need not be defined if you are using the XMLUI interface, or for steps which only perform automated processing, i.e. non-interactive steps.</em></li>
	<li><b>xmlui-binding</b>: Full Java path of the XMLUI "binding" class for this Step. This "binding" class should generate the Manakin XML (DRI document) necessary to generate the step's user interface. A valid XMLUI "binding" class <em>must</em> extend the abstract <tt>org.dspace.app.xmlui.submission.AbstractSubmissionStep</tt> class. <em>This property need not be defined if you are using the JSPUI interface, or for steps which only perform automated processing, i.e. non-interactive steps.</em></li>
	<li><b>workflow-editable</b>: Defines whether or not this step can be edited during the <em>Edit Metadata</em> process with the DSpace approval/rejection workflow process. Possible values include <em>true</em> and <em>false</em>. If undefined, defaults to <em>true</em> (which means that workflow reviewers would be allowed to edit information gathered during that step).</li>
</ul>



<h2><a name="SubmissionUserInterface-Reordering%2FRemovingSubmissionSteps"></a>Reordering/Removing Submission Steps</h2>

<p>The removal of existing steps and reordering of existing steps is a relatively easy process&#33;</p>

<p><b>Reordering steps</b></p>

<ol>
	<li>Locate the <em>&lt;submission-process&gt;</em> tag which defines the Submission Process that you are using. If you are unsure which Submission Process you are using, it's likely the one with <em>name="traditional"</em>, since this is the traditional DSpace submission process.</li>
	<li>Reorder the <em>&lt;step&gt;</em> tags within that <em>&lt;submission-process&gt;</em> tag. Be sure to move the <em>entire</em><em>&lt;step&gt;</em> tag (i.e. everything between and including the opening <em>&lt;step&gt;</em> and closing <em>&lt;/step&gt;</em> tags).
	<ul>
		<li><em>Hint #1:</em> The <em>&lt;step&gt;</em> defining the <em>Review/Verify</em> step only allows the user to review information from steps which appear <b>before</b> it. So, it's likely you'd want this to appear as one of your last few steps</li>
		<li><em>Hint #2:</em> If you are using it, the <em>&lt;step&gt;</em> defining the <em>Initial Questions</em> step should always appear <b>before</b> the <em>Upload</em> or <em>Describe</em> steps since it asks questions which help to set up those later steps.</li>
	</ul>
	</li>
</ol>


<p><b>Removing one or more steps</b></p>

<ol>
	<li>Locate the <em>&lt;submission-process&gt;</em> tag which defines the Submission Process that you are using. If you are unsure which Submission Process you are using, it's likely the one with <em>name="traditional"</em>, since this is the traditional DSpace submission process.</li>
	<li>Comment out (i.e. surround with <tt>&lt;&#33;-&#45;</tt> and <tt>&#45;&#45;&gt;</tt>) the <tt>&lt;step&gt;</tt> tags which you want to remove from that <em>&lt;submission-process&gt;</em> tag. Be sure to comment out the <em>entire {{&lt;step&gt;}}tag (i.e. everything between and including the opening _&lt;step&gt;</em> and closing <em>&lt;/step&gt;</em> tags).
	<ul>
		<li><em>Hint #1:</em> You cannot remove the <em>Select a Collection</em> step, as an DSpace Item cannot exist without belonging to a Collection.</li>
		<li><em>Hint #2:</em> If you decide to remove the <em>&lt;step&gt;</em> defining the <em>Initial Questions</em> step, you should be aware that this may affect your <em>Describe</em> and <em>Upload</em> steps&#33; The <em>Initial Questions</em> step asks questions which help to initialize these later steps. If you decide to remove the <em>Initial Questions</em> step you may wish to create a custom, automated step which will provide default answers for the questions asked&#33;</li>
	</ul>
	</li>
</ol>


<h2><a name="SubmissionUserInterface-AssigningacustomSubmissionProcesstoaCollection"></a>Assigning a custom Submission Process to a Collection</h2>

<p>Assigning a custom submission process to a Collection in DSpace involves working with the <em>submission-map</em> section of the <em>item-submission.xml</em>. For a review of the structure of the <em>item-submission.xml</em> see the section above on Understanding the Submission Configuration File.</p>

<p>Each <em>name-map</em> element within <em>submission-map</em> associates a collection with the name of a submission definition. Its <em>collection-handle</em> attribute is the Handle of the collection. Its <em>submission-name</em> attribute is the submission definition name, which must match the <em>name</em> attribute of a <em>submission-process</em> element (in the <em>submission-definitions</em> section of <em>item-submission.xml</em>.</p>

<p>For example, the following fragment shows how the collection with handle "12345.6789/42" is assigned the "custom" submission process:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;submission-map&gt;
    &lt;name-map collection-handle=<span class="code-quote">" 12345.6789/42"</span> submission-name="
	custom" /&gt;
    ...
  &lt;/submission-map&gt;

  &lt;submission-definitions&gt;
    &lt;submission-process name="
	custom"&gt;
    ...
  &lt;/submission-definitions&gt;
</pre>
</div></div>

<p>It's a good idea to keep the definition of the <em>default</em> name-map from the example <em>input-forms.xml</em> so there is always a default for collections which do not have a custom form set.</p>

<h3><a name="SubmissionUserInterface-GettingACollection%27sHandle"></a>Getting A Collection's Handle</h3>

<p>You will need the <em>handle</em> of a collection in order to assign it a custom form set. To discover the handle, go to the "Communities &amp; Collections" page under "Browse" in the left-hand menu on your DSpace home page. Then, find the link to your collection. It should look something like:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">http:<span class="code-comment">//myhost.my.edu/dspace/handle/12345.6789/42</span></pre>
</div></div>

<p>The underlined part of the URL is the handle. It should look familiar to any DSpace administrator. That is what goes in the <em>collection-handle</em> attribute of your <em>name-map</em> element.</p>


<h2><a name="SubmissionUserInterface-CustomMetadataentryPagesforSubmission"></a>Custom Metadata-entry Pages for Submission</h2>

<h3><a name="SubmissionUserInterface-Introduction"></a>Introduction</h3>

<p>This section explains how to customize the Web forms used by submitters and editors to enter and modify the metadata for a new item. These metadata web forms are controlled by the <em>Describe</em> step within the Submission Process. However, they are also configurable via their own XML configuration file (<em>input-forms.xml</em>).</p>

<p>You can customize the "default" metadata forms used by all collections, and also create alternate sets of metadata forms and assign them to specific collections. In creating custom metadata forms, you can choose:</p>

<ul>
	<li>The number of metadata-entry pages.</li>
	<li>Which fields appear on each page, and their sequence.</li>
	<li>Labels, prompts, and other text associated with each field.</li>
	<li>List of available choices for each menu-driven field.</li>
</ul>


<p>NOTE: The cosmetic and ergonomic details of metadata entry fields remain the same as the fixed metadata pages in previous DSpace releases, and can only be altered by modifying the appropriate stylesheet and JSP pages.</p>

<p>All of the custom metadata-entry forms for a DSpace instance are controlled by a single XML file, <em>input-forms.xml</em>, in the <em>config</em> subdirectory under the DSpace home. DSpace comes with a sample configuration that implements the traditional metadata-entry forms, which also serves as a well-documented example. The rest of this section explains how to create your own sets of custom forms.</p>


<h3><a name="SubmissionUserInterface-DescribingCustomMetadataForms"></a>Describing Custom Metadata Forms</h3>

<p>The description of a set of pages through which submitters enter their metadata is called a <em>form</em> (although it is actually a set of forms, in the HTML sense of the term). A form is identified by a unique symbolic <em>name</em>. In the XML structure, the <em>form</em> is broken down into a series of <em>pages</em>: each of these represents a separate Web page for collecting metadata elements.</p>

<p>To set up one of your DSpace collections with customized submission forms, first you make an entry in the <em>form-map</em>. This is effectively a table that relates a collection to a form set, by connecting the collection's <em>Handle</em> to the form name. Collections are identified by handle because their names are mutable and not necessarily unique, while handles are unique and persistent.</p>

<p>A special map entry, for the collection handle "default", defines the <em>default</em> form set. It applies to all collections which are not explicitly mentioned in the map. In the example XML this form set is named <em>traditional</em> (for the "traditional" DSpace user interface) but it could be named anything.</p>


<h3><a name="SubmissionUserInterface-TheStructureofinputforms.xml"></a>The Structure of <em>input-forms.xml</em></h3>

<p>The XML configuration file has a single top-level element, <em>input-forms</em>, which contains three elements in a specific order. The outline is as follows:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;input-forms&gt;

  &lt;--  Map of Collections to Form Sets --&gt;
  &lt;form-map&gt;
    &lt;name-map collection-handle=<span class="code-quote">"<span class="code-keyword">default</span>"</span> form-name=<span class="code-quote">"traditional"</span>
	/&gt;
    ...
  &lt;/form-map&gt;

  &lt;--  Form Set Definitions --&gt;
  &lt;form-definitions&gt;
    &lt;form name=<span class="code-quote">"traditional"</span>&gt;
    ...
  &lt;/form-definitions&gt;

  &lt;--  Name/Value Pairs used within Multiple Choice Widgets
	--&gt;
  &lt;form-value-pairs&gt;
    &lt;value-pairs value-pairs-name=<span class="code-quote">"common_iso_languages"</span>
	dc-term=<span class="code-quote">"language_iso"</span>&gt;
    ...
  &lt;/form-value-pairs&gt;
&lt;/input-forms&gt;
</pre>
</div></div>

<h4><a name="SubmissionUserInterface-AddingaCollectionMap"></a>Adding a Collection Map</h4>

<p>Each <em>name-map</em> element within <em>form-map</em> associates a collection with the name of a form set. Its <em>collection-handle</em> attribute is the Handle of the collection, and its <em>form-name</em> attribute is the form set name, which must match the <em>name</em> attribute of a <em>form</em> element.</p>

<p>For example, the following fragment shows how the collection with handle "12345.6789/42" is attached to the "TechRpt" form set:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
  &lt;form-map&gt;
    &lt;name-map collection-handle=<span class="code-quote">" 12345.6789/42"</span> form-name=<span class="code-quote">" TechRpt"</span>/&gt;
    ...
  &lt;/form-map&gt;

  &lt;form-definitions&gt;
    &lt;form name=<span class="code-quote">"TechRept"</span>&gt;
    ...
  &lt;/form-definitions&gt;
</pre>
</div></div>

<p>It's a good idea to keep the definition of the <em>default</em> name-map from the example <em>input-forms.xml</em> so there is always a default for collections which do not have a custom form set.</p>

<h5><a name="SubmissionUserInterface-GettingACollection%27sHandle"></a>Getting A Collection's Handle</h5>

<p>You will need the <em>handle</em> of a collection in order to assign it a custom form set. To discover the handle, go to the "Communities &amp; Collections" page under "<b>Browse</b>" in the left-hand menu on your DSpace home page. Then, find the link to your collection. It should look something like:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">http:<span class="code-comment">//myhost.my.edu/dspace/handle/12345.6789/42</span></pre>
</div></div>

<p>The underlined part of the URL is the handle. It should look familiar to any DSpace administrator. That is what goes in the <em>collection-handle</em> attribute of your <em>name-map</em> element.</p>



<h4><a name="SubmissionUserInterface-AddingaFormSet"></a>Adding a Form Set</h4>

<p>You can add a new form set by creating a new <em>form</em> element within the <em>form-definitions</em> element. It has one attribute, <em>name</em>, which as seen above must match the value of the <em>name-map</em> for the collections it is to be used for.</p>

<h5><a name="SubmissionUserInterface-FormsandPages"></a>Forms and Pages</h5>

<p>The content of the <em>form</em> is a sequence of <em>page</em> elements. Each of these corresponds to a Web page of forms for entering metadata elements, presented in sequence between the initial "Describe" page and the final "Verify" page (which presents a summary of all the metadata collected).</p>

<p>A <em>form</em> must contain at least one and at most six pages. They are presented in the order they appear in the XML. Each <em>page</em> element must include a <em>number</em> attribute, that should be its sequence number, e.g.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;page number=<span class="code-quote">"1"</span>&gt;
</pre>
</div></div>

<p>The <em>page</em> element, in turn, contains a sequence of <em>field</em> elements. Each field defines an interactive dialog where the submitter enters one of the Dublin Core metadata items.</p>


<h5><a name="SubmissionUserInterface-CompositionofaField"></a>Composition of a Field</h5>

<p>Each <em>field</em> contains the following elements, in the order indicated. The required sub-elements are so marked:</p>

<ul>
	<li><b>dc-schema</b> (Required) : Name of metadata schema employed, e.g. <em>dc</em> for Dublin Core. This value must match the value of the <em>schema</em> element defined in <em>dublin-core-types.xml</em></li>
	<li><b>dc-element</b> (Required) : Name of the Dublin Core element entered in this field, e.g. <em>contributor</em>.</li>
	<li><b>dc-qualifier</b>: Qualifier of the Dublin Core element entered in this field, e.g. when the field is <em>contributor.advisor</em> the value of this element would be <em>advisor</em>. Leaving this out means the input is for an unqualified DC element.</li>
	<li><b>repeatable</b>: Value is <em>true</em> when multiple values of this field are allowed, <em>false</em> otherwise. When you mark a field repeatable, the UI servlet will add a control to let the user ask for more fields to enter additional values. Intended to be used for arbitrarily-repeating fields such as subject keywords, when it is impossible to know in advance how many input boxes to provide.</li>
	<li><b>label</b> (Required): Text to display as the label of this field, describing what to enter, e.g. "<em>Your Advisor's Name</em>".</li>
	<li><b>input-type</b> (Required): Defines the kind of interactive widget to put in the form to collect the Dublin Core value. Content must be one of the following keywords:
	<ul>
		<li><b>onebox</b> &#8211; A single text-entry box.</li>
		<li><b>twobox</b> &#8211; A pair of simple text-entry boxes, used for <em>repeatable</em> values such as the DC <em>subject</em> item. <em>Note:</em> The 'twobox' input type is rendered the same as a 'onebox' in the XML-UI, but both allow for ease of adding multiple values.</li>
		<li><b>textarea</b> &#8211; Large block of text that can be entered on multiple lines, e.g. for an abstract.</li>
		<li><b>name</b> &#8211; Personal name, with separate fields for family name and first name. When saved they are appended in the format 'LastName, FirstName'</li>
		<li><b>date</b> &#8211; Calendar date. When required, demands that at least the year be entered.</li>
		<li><b>series</b> &#8211; Series/Report name and number. Separate fields are provided for series name and series number, but they are appended (with a semicolon between) when saved.</li>
		<li><b>dropdown</b> &#8211; Choose value(s) from a "drop-down" menu list. <b>Note:</b> You must also include a value for the <em>value-pairs-name</em> attribute to specify a list of menu entries from which to choose. Use this to make a choice from a restricted set of options, such as for the <em>language</em> item.</li>
		<li><b>qualdrop_value</b> &#8211; Enter a "qualified value", which includes <em>both</em> a qualifier from a drop-down menu and a free-text value. Used to enter items like alternate identifiers and codes for a submitted item, e.g. the DC <em>identifier</em> field. <b>Note:</b> As for the <em>dropdown</em> type, you must include the <em>value-pairs-name</em> attribute to specify a menu choice list.</li>
		<li><b>list</b> &#8211; Choose value(s) from a checkbox or radio button list. If the <em>repeatable</em> attribute is set to <em>true</em>, a list of checkboxes is displayed. If the <em>repeatable</em> attribute is set to <em>false</em>, a list of radio buttons is displayed. <b>Note:</b> You must also include a value for the <em>value-pairs-name</em> attribute to specify a list of values from which to choose.</li>
	</ul>
	</li>
	<li><b>hint</b> (Required): Content is the text that will appear as a "hint", or instructions, next to the input fields. Can be left empty, but it must be present.</li>
	<li><b>required</b>: When this element is included with any content, it marks the field as a required input. If the user tries to leave the page without entering a value for this field, that text is displayed as a warning message. For example, <em>&lt;required&gt;You must enter a title.&lt;/required&gt; Note that leaving the</em> required element empty will <em>not</em> mark a field as required, e.g.:<em>&lt;required&gt;&lt;/required&gt;</em></li>
	<li><b>visibility</b>: When this optional element is included with a value, it restricts the visibility of the field to the scope defined by that value. If the element is missing or empty, the field is visible in all scopes. Currently supported scopes are:
	<ul>
		<li><b>workflow</b> : the field will only be visible in the workflow stages of submission. This is good for hiding difficult fields for users, such as subject classifications, thereby easing the use of the submission system.</li>
		<li><b>submit</b> : the field will only be visible in the initial submission, and not in the workflow stages. In addition, you can decide which type of restriction apply: read-only or full hidden the field (default behaviour) using the <em>otherwise</em> attribute of the <em>visibility</em> XML element. For example:<em>&lt;visibility otherwise="readonly"&gt;workflow&lt;/visibility&gt;</em> Note that it is considered a configuration error to limit a field's scope while also requiring it - an exception will be generated when this combination is detected.<br/>
Look at the example <em>input-forms.xml</em> and experiment with a a trial custom form to learn this specification language thoroughly. It is a very simple way to express the layout of data-entry forms, but the only way to learn all its subtleties is to use it.</li>
	</ul>
	</li>
</ul>


<p>For the use of controlled vocabularies see the Configuring Controlled Vocabularies section.</p>


<h5><a name="SubmissionUserInterface-AutomaticallyElidedFields"></a>Automatically Elided Fields</h5>

<p>You may notice that some fields are automatically skipped when a custom form page is displayed, depending on the kind of item being submitted. This is because the DSpace user-interface engine skips Dublin Core fields which are not needed, according to the initial description of the item. For example, if the user indicates there are no alternate titles on the first "Describe" page (the one with a few checkboxes), the input for the <em>title.alternative</em> DC element is automatically elided, <em>even on custom submission pages.</em></p>

<p>When a user initiates a submission, DSpace first displays what we'll call the "initial-questions page". By default, it contains three questions with check-boxes:</p>
<ol>
	<li><b>The item has more than one title, e.g. a translated title</b> Controls <em>title.alternative</em> field.</li>
	<li><b>The item has been published or publicly distributed before</b> Controls DC fields:
	<ul>
		<li><em>date.issued</em></li>
		<li><em>publisher</em></li>
		<li><em>identifier.citation</em></li>
	</ul>
	</li>
	<li><b>The item consists of more than one file</b> <em>Does not affect any metadata input fields.</em></li>
</ol>


<p>The answers to the first two questions control whether inputs for certain of the DC metadata fields will displayed, even if they are defined as fields in a custom page. Conversely, if the metadata fields controlled by a checkbox are not mentioned in the custom form, the checkbox is elided from the initial page to avoid confusing or misleading the user.</p>

<p>The two relevant checkbox entries are "The item has more than one title, e.g. a translated title", and "The item has been published or publicly distributed before". The checkbox for multiple titles trigger the display of the field with dc-element equal to 'title' and dc-qualifier equal to 'alternative'. If the controlling collection's form set does not contain this field, then the multiple titles question will not appear on the initial questions page.</p>


<h4><a name="SubmissionUserInterface-AddingValuePairs"></a>Adding Value-Pairs</h4>

<p>Finally, your custom form description needs to define the "value pairs" for any fields with input types that refer to them. Do this by adding a <em>value-pairs</em> element to the contents of <em>form-value-pairs</em>. It has the following required attributes:</p>
<ul>
	<li><b>value-pairs-name</b> &#8211; Name by which an <em>input-type</em> refers to this list.</li>
	<li><b>dc-term</b> &#8211; Qualified Dublin Core field for which this choice list is selecting a value. Each <em>value-pairs</em> element contains a sequence of <em>pair</em> sub-elements, each of which in turn contains two elements:</li>
	<li><b>displayed-value</b> &#8211; Name shown (on the web page) for the menu entry.</li>
	<li><b>stored-value</b> &#8211; Value stored in the DC element when this entry is chosen. Unlike the HTML <em>select</em> tag, there is no way to indicate one of the entries should be the default, so the first entry is always the default choice.</li>
</ul>


<h5><a name="SubmissionUserInterface-Example"></a>Example</h5>

<p>Here is a menu of types of common identifiers:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
   &lt;value-pairs value-pairs-name=<span class="code-quote">"common_identifiers"</span> dc-term=<span class="code-quote">"identifier"</span>&gt;
     &lt;pair&gt;
       &lt;displayed-value&gt;Gov't Doc #&lt;/displayed-value&gt;
       &lt;stored-value&gt;govdoc&lt;/stored-value&gt;
     &lt;/pair&gt;
     &lt;pair&gt;
       &lt;displayed-value&gt;URI&lt;/displayed-value&gt;
       &lt;stored-value&gt;uri&lt;/stored-value&gt;
     &lt;/pair&gt;
     &lt;pair&gt;
       &lt;displayed-value&gt;ISBN&lt;/displayed-value&gt;
       &lt;stored-value&gt;isbn&lt;/stored-value&gt;
     &lt;/pair&gt;
   &lt;/value-pairs&gt;
</pre>
</div></div>

<p>It generates the following HTML, which results in the menu widget below. (Note that there is no way to indicate a default choice in the custom input XML, so it cannot generate the HTML <em>SELECTED</em> attribute to mark one of the options as a pre-selected default.) </p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;select name=<span class="code-quote">"identifier_qualifier_0"</span>&gt;
    &lt;option VALUE=<span class="code-quote">"govdoc"</span>&gt;Gov't Doc #&lt;/option&gt;
    &lt;option VALUE=<span class="code-quote">"uri"</span>&gt;URI&lt;/option&gt;
    &lt;option VALUE=<span class="code-quote">"isbn"</span>&gt;ISBN&lt;/option&gt;
&lt;/select&gt;
</pre>
</div></div>


<h3><a name="SubmissionUserInterface-DeployingYourCustomForms"></a>Deploying Your Custom Forms</h3>

<p>The DSpace web application only reads your custom form definitions when it starts up, so it is important to remember:</p>
<ul>
	<li><em>You must always restart Tomcat</em> (or whatever servlet container you are using) for changes made to the <em>input-forms.xml</em> file take effect.</li>
</ul>


<p>Any mistake in the syntax or semantics of the form definitions, such as poorly formed XML or a reference to a nonexistent field name, will cause a fatal error in the DSpace UI. The exception message (at the top of the stack trace in the <em>dspace.log</em> file) usually has a concise and helpful explanation of what went wrong. Don't forget to stop and restart the servlet container before testing your fix to a bug.</p>


<h2><a name="SubmissionUserInterface-ConfiguringtheFileUploadstep"></a>Configuring the File Upload step</h2>

<p>The <em>Upload</em> step in the DSpace submission process has two configuration options which can be set with your <em>[dspace]/config/dspace.cfg</em> configuration file. They are as follows:</p>

<ul>
	<li><em>upload.max</em> &#45; The maximum size of a file (in bytes) that can be uploaded from the JSPUI (not applicable for the XMLUI). It defaults to 536870912 bytes (512MB). You may set this to &#45;1 to disable any file size limitation.
	<ul>
		<li><em>Note:</em> Increasing this value or setting to &#45;1 does <b>not</b> guarantee that DSpace will be able to successfully upload larger files via the web, as large uploads depend on many other factors including bandwidth, web server settings, internet connection speed, etc.</li>
	</ul>
	</li>
	<li><em>webui.submit.upload.required</em> &#45; Whether or not all users are <em>required</em> to upload a file when they submit an item to DSpace. It defaults to 'true'. When set to 'false' users will see an option to skip the upload step when they submit a new item.</li>
</ul>


<h2><a name="SubmissionUserInterface-CreatingnewSubmissionSteps"></a>Creating new Submission Steps</h2>

<p>First, a brief warning: <em>Creating a new Submission Step requires some Java knowledge, and is therefore recommended to be undertaken by a Java programmer whenever possible</em></p>

<p>That being said, at a higher level, creating a new Submission Step requires the following (in this relative order):</p>

<ol>
	<li>(<b>Required</b>) Create a new Step Processing class
	<ul>
		<li>This class <b>must</b> extend the abstract <tt>org.dspace.submit.AbstractProcessingStep</tt> class and implement all methods defined by that abstract class.</li>
		<li>This class should be built in such a way that it can process the input gathered from <em>either</em> the XMLUI or JSPUI interface.</li>
	</ul>
	</li>
	<li>(<em>For steps using JSPUI</em>) Create the JSPs to display the user interface. Create a new JSPUI "binding" class to initialize and call these JSPs.
	<ul>
		<li>Your JSPUI "binding" class must extend the abstract class <tt>org.dspace.app.webui.submit.JSPStep</tt> and implement all methods defined there. It's recommended to use one of the classes in <tt>org.dspace.app.webui.submit.step.&#42;</tt> as a reference.</li>
		<li>Any JSPs created should be loaded by calling the showJSP() method of the <tt>org.dspace.app.webui.submit.JSPStepManager</tt> class</li>
		<li>If this step gathers information to be reviewed, you must also create a Review JSP which will display a read-only view of all data gathered during this step. The path to this JSP must be returned by your getReviewJSP() method. You will find examples of Review JSPs (named similar to <tt>review-[step].jsp</tt>) in the JSP <tt>submit/</tt> directory.</li>
	</ul>
	</li>
	<li>(<em>For steps using XMLUI</em>) Create an XMLUI "binding" Step Transformer which will generate the DRI XML which Manakin requires.
	<ul>
		<li>The Step Transformer must extend and implement all necessary methods within the abstract class <tt>org.dspace.app.xmlui.submission.AbstractSubmissionStep</tt></li>
		<li>It is useful to use the existing classes in <tt>org.dspace.app.xmlui.submission.submit.&#42;</tt> as references</li>
	</ul>
	</li>
	<li>(<b>Required</b>) Add a valid Step Definition to the <tt>item-submission.xml</tt> configuration file.
	<ul>
		<li>This may also require that you add an I18N (Internationalization) key for this step's <em>heading</em>. See the sections on <a href="Configuration.html#Configuration-JSPUIConfiguringMultilingualSupport">Configuring Multilingual Support for JSPUI</a> or <a href="XMLUI Configuration and Customization.html#XMLUIConfigurationandCustomization-MultilingualSupport">Configuring Multilingual Support for XMLUI</a> for more details.</li>
		<li>For more information on <em>&lt;step&gt;</em> definitions within the <tt>item-submission.xml</tt>, see the section above on Defining Steps (<em>&lt;step&gt;</em>) within the <tt>item-submission.xml</tt>.</li>
	</ul>
	</li>
</ol>


<h3><a name="SubmissionUserInterface-CreatingaNonInteractiveStep"></a>Creating a Non-Interactive Step</h3>

<p>Non-interactive steps are ones that have no user interface and only perform backend processing. You may find a need to create non-interactive steps which perform further processing of previously entered information.</p>

<p>To create a non-interactive step, do the following:</p>

<ol>
	<li>Create the required Step Processing class, which extends the abstract <tt>org.dspace.submit.AbstractProcessingStep</tt> class. In this class add any processing which this step will perform.</li>
	<li>Add your non-interactive step to your <em>item-submission.xml</em> at the place where you wish this step to be called during the submission process. For example, if you want it to be called <em>immediately after</em> the existing 'Upload File' step, then place its configuration immediately after the configuration for that 'Upload File' step. The configuration should look similar to the following:</li>
</ol>


<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;step&gt;
   &lt;processing-class&gt;org.dspace.submit.step.MyNonInteractiveStep&lt;/processing-class&gt; 
   &lt;workflow-editable&gt;<span class="code-keyword">false</span>&lt;/workflow-editable&gt;
&lt;/step&gt;</pre>
</div></div>

<p>Note: Non-interactive steps will not appear in the Progress Bar&#33; Therefore, your submitters will not even know they are there. However, because they are not visible to your users, you should make sure that your non-interactive step does not take a large amount of time to finish its processing and return control to the next step (otherwise there will be a visible time delay in the user interface).</p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="https://wiki.duraspace.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Mar 25, 2011 19:21</font></td>
		    </tr>
	    </table>
    </body>
</html>