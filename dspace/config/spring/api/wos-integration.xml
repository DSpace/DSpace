<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-2.5.xsd
                           http://www.springframework.org/schema/util
                           http://www.springframework.org/schema/util/spring-util.xsd"
       default-autowire-candidates="*Service,*DAO,javax.sql.DataSource">

    <context:annotation-config/>
    <!-- allows us to use spring annotations in beans -->

    <util:list id="wosMetadataFieldMap"
              value-type="org.dspace.importer.external.metadatamapping.contributor.MetadataContributor">
        <description>Defines which metadatum is mapped on which metadatum.
        </description>
        <ref bean="wosCitationEditionContrib"/>
        <ref bean="wosPubyearContrib"/>
        <ref bean="wosStartPageContrib"/>
        <ref bean="wosEndPageContrib"/>
        <ref bean="wosTypeContrib"/>
        <ref bean="wosVolumeContrib"/>
        <ref bean="wosIspartofContrib"/>
        <ref bean="wosIspartofseriesContrib"/>
        <ref bean="wosTitleContrib"/>
        <ref bean="wosIdentifierContrib"/>
        <ref bean="wosIssueContrib"/>
        <ref bean="wosAbstractContrib"/>
        <ref bean="wosLanguageIsoContrib"/>
        <ref bean="wosFullNameContrib"/>
        <ref bean="wosSubjectContrib"/>
        <ref bean="wosOrcidContrib"/>
        <ref bean="wosPublisherContrib"/>
        <ref bean="wosContributorEditorContrib"/>
        <ref bean="wosIdContrib"/>
        <ref bean="wosRidContrib"/>
    </util:list>
 
    <bean id="wosCitationEditionContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="oaire.citation.edition"/>
        <property name="query" value="static_data/summary/EWUID/edition/@value"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosPubyearContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="dc.date.issued"/>
        <property name="query" value="static_data/summary/pub_info/@pubyear"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosStartPageContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="oaire.citation.startPage"/>
        <property name="query" value="static_data/summary/pub_info/page/@begin"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosEndPageContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="oaire.citation.endPage"/>
        <property name="query" value="static_data/summary/pub_info/page/@end"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosTypeContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="dc.type"/>
        <property name="query" value="static_data/summary/pub_info/@pubtype"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosVolumeContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="oaire.citation.volume"/>
        <property name="query" value="static_data/summary/pub_info/@vol"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosIssueContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="oaire.citation.issue"/>
        <property name="query" value="static_data/summary/pub_info/@issue"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosIdentifierContrib" class="org.dspace.importer.external.metadatamapping.contributor.WosIdentifierContributor">
        <property name="field" ref="dc.identifier"/>
        <property name="query" value="dynamic_data/cluster_related/identifiers/identifier"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
        <property name="identifier2field" ref="identifiers2fields"/>
    </bean>

    <util:map id="identifiers2fields" map-class="java.util.HashMap"
        key-type="java.lang.String" value-type="org.dspace.importer.external.metadatamapping.MetadataFieldConfig">
        <entry key="doi" value-ref="dc.identifier" />
        <entry key="issn" value-ref="dc.identifier.issn" />
        <entry key="eisbn" value-ref="dc.identifier.isbn" />
    </util:map>

    <bean id="wosLanguageIsoContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="dc.language.iso"/>
        <property name="query" value="static_data/fullrecord_metadata/normalized_languages/@count"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosTitleContrib" class="org.dspace.importer.external.metadatamapping.contributor.WosAttribute2ValueContributor">
        <property name="query" value="static_data/summary/titles/title"/>
        <property name="attribute" value="type"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
        <property name="attributeValue2metadata" ref="title2fields"/>
    </bean>

    <util:map id="title2fields" map-class="java.util.HashMap"
        key-type="java.lang.String" value-type="org.dspace.importer.external.metadatamapping.MetadataFieldConfig">
        <entry key="item" value-ref="dc.title" />
    </util:map>

    <bean id="wosFullNameContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="dc.contributor.author"/>
        <property name="query" value="static_data/summary/names/name/full_name"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosAbstractContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleConcatContributor">
        <property name="field" ref="dc.description.abstract"/>
        <property name="query" value="static_data/fullrecord_metadata/abstracts/abstract/abstract_text/p"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosSubjectContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleMultiplePathContributor">
        <property name="field" ref="dc.subject"/>
        <property name="paths" ref="paths"/>
        <property name="query" value=""/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>
    <util:list id="paths" value-type="java.lang.String">
        <value>static_data/item/keywords_plus/keyword</value>
        <value>static_data/fullrecord_metadata/keywords/keyword</value>
        <value>static_data/fullrecord_metadata/category_info/headings/heading</value>
        <value>static_data/fullrecord_metadata/category_info/subheadings/subheading</value>
    </util:list>

    <bean id="wosOrcidContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumAndAttributeContributor">
        <property name="field" ref="person.identifier.orcid"/>
        <property name="attribute" value="orcid_id"/>
        <property name="query" value="static_data/summary/names/name"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosPublisherContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="dc.publisher"/>
        <property name="query" value="static_data/summary/publishers/publisher/names/name/display_name"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <bean id="wosIspartofContrib" class="org.dspace.importer.external.metadatamapping.contributor.WosAttribute2ValueContributor">
        <property name="attribute" value="type"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
        <property name="query" value="static_data/summary/titles/title"/>
        <property name="attributeValue2metadata" ref="ispartof2fields"/>
    </bean>

    <util:map id="ispartof2fields" map-class="java.util.HashMap"
        key-type="java.lang.String" value-type="org.dspace.importer.external.metadatamapping.MetadataFieldConfig">
        <entry key="source" value-ref="dc.relation.ispartof" />
    </util:map>

    <bean id="wosIspartofseriesContrib" class="org.dspace.importer.external.metadatamapping.contributor.WosAttribute2ValueContributor">
        <property name="attribute" value="type"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
        <property name="query" value="static_data/summary/titles/title"/>
        <property name="attributeValue2metadata" ref="ispartofseries2fields"/>
    </bean>

    <util:map id="ispartofseries2fields" map-class="java.util.HashMap"
        key-type="java.lang.String" value-type="org.dspace.importer.external.metadatamapping.MetadataFieldConfig">
        <entry key="source" value-ref="dc.relation.ispartofseries" />
    </util:map>

    <bean id="wosContributorEditorContrib" class="org.dspace.importer.external.metadatamapping.contributor.WosAttribute2ValueContributor">
        <property name="attribute" value="role"/>
        <property name="firstChild" value="true"/>
        <property name="childName" value="full_name"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
        <property name="query" value="static_data/summary/names/name"/>
        <property name="attributeValue2metadata" ref="contributorEditor2fields"/>
    </bean>

    <bean id="wosIdContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleXpathMetadatumContributor">
        <property name="field" ref="dc.identifier.other"/>
        <property name="query" value="UID"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <util:map id="contributorEditor2fields" map-class="java.util.HashMap"
        key-type="java.lang.String" value-type="org.dspace.importer.external.metadatamapping.MetadataFieldConfig">
        <entry key="book_editor" value-ref="dc.contributor.editor" />
    </util:map>

    <bean id="wosRidContrib" class="org.dspace.importer.external.metadatamapping.contributor.WosIdentifierRidContributor">
        <property name="field" ref="person.identifier.rid"/>
        <property name="query" value="static_data/contributors/contributor"/>
        <property name="prefixToNamespaceMapping" ref="wosNs"/>
    </bean>

    <util:map id="wosNs" map-class="java.util.HashMap"
        key-type="java.lang.String" value-type="java.lang.String">
    </util:map>

</beans>
