<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-2.5.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"
       default-autowire-candidates="*Service,*DAO,javax.sql.DataSource">

    <context:annotation-config/>
    <!-- allows us to use spring annotations in beans -->

    <util:list id="vufindMetadataFieldMap"
              value-type="org.dspace.importer.external.metadatamapping.contributor.MetadataContributor">
        <description>Defines which metadatum is mapped on which metadatum.</description>
        <ref bean="vufindIDContrib"/>
        <ref bean="vufindLanguages"/>
        <ref bean="vufindPublisher"/>
        <ref bean="vufindTitle"/>
        <ref bean="vufindIdentifier"/>
        <ref bean="vufindAuthors"/>
        <ref bean="vufindSubject"/>
        <ref bean="vufindAbstract"/>
        <ref bean="vufindTitleAlternative"/>
        <ref bean="vufindContributorEditor"/>
        <ref bean="vufindDateIssued"/>
        <ref bean="vufindIdentifierDoi"/>
        <ref bean="vufindIdentifierIsbn"/>
    </util:list>

    <bean id="vufindIDContrib" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.identifier.other"/>
        <property name="query" value="/id"/>
    </bean>

    <bean id="vufindLanguages" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.language.iso"/>
        <property name="query" value="/languages"/>
    </bean>

    <bean id="vufindTitle" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.title"/>
        <property name="query" value="/title"/>
    </bean>

    <bean id="vufindIdentifier" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.identifier"/>
        <property name="metadataProcessor" ref="vufindUriProcessor"></property>
    </bean>
    <bean name="vufindUriProcessor" class="org.dspace.importer.external.metadatamapping.contributor.ArrayElementAttributeProcessor">
        <property name="pathToArray" value="/urls"></property>
        <property name="elementAttribute" value="/url"></property>
	</bean>

    <bean id="vufindSubject" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.subject"/>
        <property name="metadataProcessor" ref="vufindSubjectsProcessor"></property>
    </bean>
    <bean name="vufindSubjectsProcessor" class="org.dspace.importer.external.metadatamapping.contributor.MatrixElementProcessor">
        <property name="pathToMatrix" value="/subjects"></property>
	</bean>

    <bean id="vufindAuthors" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.contributor.author"/>
        <property name="query" value="/dcContributorAuthor"/>
    </bean>

	<util:list id="vufindAuthorsList">
	    <bean id="vufindPrimaryAuthors" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
	        <property name="field" ref="dc.contributor.author"/>
	        <property name="query" value="/authors/primary" />
	    </bean>
	    <bean id="vufindSecondaryAuthors" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
	        <property name="field" ref="dc.contributor.author"/>
	        <property name="query" value="/authors/secondary" />
	    </bean>
	</util:list>

    <bean class="java.lang.Integer" id="maxRetry">
        <constructor-arg value="3"/>
    </bean>

    <!-- Below there are other mapping that apply to an extended configuration in use for instance at the vuFind installation
         of ALICIA https://alicia.concytec.gob.pe/vufind/Search/Results?type=AllFields -->

    <bean id="vufindIdentifierIsbn" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.identifier.isbn"/>
        <property name="query" value="/dcIdentifierIsbn"/>
    </bean>

    <bean id="vufindIdentifierDoi" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.identifier.doi"/>
        <property name="query" value="/dcIdentifierDoi"/>
    </bean>

    <bean id="vufindDateIssued" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.date.issued"/>
        <property name="query" value="/dcDateIssued"/>
    </bean>

    <bean id="vufindContributorEditor" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.contributor.editor"/>
        <property name="query" value="/dcContributorEditor"/>
    </bean>

    <bean id="vufindTitleAlternative" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.title.alternative"/>
        <property name="query" value="/dcTitleAlternative"/>
    </bean>

    <bean id="vufindAbstract" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.description.abstract"/>
        <property name="query" value="/dcDescriptionAbstract"/>
    </bean>

    <bean id="vufindPublisher" class="org.dspace.importer.external.metadatamapping.contributor.SimpleJsonPathMetadataContributor">
        <property name="field" ref="dc.publisher"/>
        <property name="query" value="/dcPublisher"/>
    </bean>

</beans>
