<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<HTML>
  <HEAD>
    <TITLE>DSpace System Documentation: Directories and Files</TITLE>
    <LINK REL=StyleSheet HREF="style.css" TYPE="text/css">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" >
  </HEAD>
  <BODY>
    <H1>DSpace System Documentation: Directories and Files</H1>

    <P><A HREF="index.html">Back to contents</A></P>

    <H2><A NAME="overview">Overview</A></H2>

    <p>A complete DSpace installation consists of three separate directory trees:

    <dl>
      <dt>The source directory:</dt>
      <dd><p>This is where (surprise!) the source code lives.  Note that the config files here are used only during the initial install process. After the install, config files should be changed in the install directory. It is referred to in this document as <code><i>[dspace-source]</i></code>.</p></dd>

      <dt>The install directory:<dt>
      <dd><p>This directory is populated during the install process and also by DSpace as it runs.  It contains config files, command-line tools (and the libraries necessary to run them), and usually--although not necessarily--the contents of the DSpace archive (depending on how DSpace is configured). After the initial build and install, changes to config files should be made in this directory.  It is referred to in this document as <code><i>[dspace]</i></code>.<p> </dd>

      <dt>The web deployment directory: </dt>
      <dd><p>This directory is generated by the web server the first time it finds a dspace.war file in its webapps directory. It contains the unpacked contents of dspace.war, i.e. the JSPs and java classes and libraries necessary to run DSpace.  Files in this directory should never be edited directly; if you wish to modify your DSpace installation, you should edit files in the source directory and then rebuild. The contents of this directory aren't listed here since its creation is completely automatic.  It is usually referred to in this document as <code><i>[tomcat]</i>/webapps/dspace</code>.</p></dd>
    </dl>

    <H2><A NAME="sourcedir">Source Directory Layout</A></H2>

    <ul>
      <li><code><i>[dspace-source]</i></code>
        <ul>
          <li><code>bin/</code> - Some shell scripts for running DSpace command-line tasks</li>
          <li><code>build.xml</code> - build file for Ant</li>
          <li><code>config/</code> - configuration files
            <ul>
              <li><code>dspace.cfg</code> - main DSpace configuration file</li>
              <li><code>dc2mods.cfg</code> - Mappings from Dublin Core metadata to <A HREF="http://www.loc.gov/standards/mods/">MODS</A> for the METS export</li>
              <li><code>default.license</code>  - default license that users must grant when submitting items</li>
              <li><code>mediafilter.cfg</code> - Media Filter configuration</li>
              <li><code>news-side.html</code> - Text of the front-page news in the sidebar</li>
              <li><code>news-top.html</code> - Text of the front-page news in the top box</li>
              <li><code>emails/</code> - Texts of emails sent out by the system</li>
              <li><code>registries/</code> - INITIAL contents of the bitstream format registry and Dublin Core element/qualifier registry.  These are only used on initial system setup, after which they are maintained in the database.</li>
              <li><code>templates/</code> - configuration files for libraries and external applications (e.g. Apache, Tomcat) are kept and edited here.  They can refer to properties in the main DSpace configuration - have a look at a couple.  When they're updated, a command line tool fills out these files with appropriate values from dspace.cfg, and copies them to their appropriate location (hence "templates".)</li>
            </ul>
          </li>
          <li><code>etc/</code> - miscelleanous stuff that isn't really to do with system configuration - e.g. the database schema, and a couple of configuration files that are used during the build process but not by the live system.  Also contains the deployment descriptors (<code>web.xml</code> files) for the Web UI and OAI-PMH support <code>.war</code> files.</li>
          <li><code>jsp/</code> - The Web UI JSPs.  As much as possible, these are simply HTML with little bits of Java - the business code resides in the servlets</li>
          <li><code>lib/</code> - Library JARs used by the system
            <ul>
              <li><code>README</code> - Lists the packages third-party libraries (JARs) and their use</li>
              <li><code>licenses</code> - Contains the licenses associated with the JARs</li>
            </ul>
          </li>
          <li><code>src/</code> - DSpace system source code.  For details on how this is laid out, see the overview page of the Javadoc.</li>
        </ul>
      </li>
    </ul>


    <H2><A NAME="installdir">Installed Directory Layout</A></H2>

    <P>Below is the basic layout of a DSpace installation using the default configuration.  These paths can be configured if necessary.</P>


    <UL>
    <li><code><i>[dspace]</i></code>
    <UL>
    <li><code>assetstore/</code> - asset store files</li>
    <li><code>bin/</code> - shell scripts</li>
    <li><code>config/</code> - configuration</li>
    <li><code>handle-server/</code> - Handles server files</li>
    <li><code>history/</code> - history files</li>
    <li><code>lib/</code> - JARs, including dspace.jar, containing the DSpace classes</li>
    <li><code>log/</code> - Log files</li>
    <li><code>search/</code> - Lucene search index files</li>
    </ul>
    </ul>

    <H2><A NAME="logfiles">Log Files</A></H2>

    <P>The first source of potential confusion is the log files.  Since DSpace uses a number of third-party tools, problems can occur in a variety of places.  Below is a table listing the main log files used in a typical DSpace setup.  The locations given are defaults, and might be different for your system depending on where you installed DSpace and the third-party tools.  The ordering of the list is roughly the recommended order for searching them for the details about a particular problem or error.</P>

    <TABLE>
      <CAPTION>DSpace Log File Locations</CAPTION>
      <TR>
        <TH>Log File</TH>
        <TH>What's In It</TH>
      </TR>
      <TR>
        <TD><code><i>[dspace]</i>/log/dspace.log</code></TD>
        <TD>Main DSpace log file.  This is where the DSpace code writes a simple log of events and errors that occur within the DSpace code.  You can control the verbosity of this by editing the <code><i>[dspace]</i>/config/templates/log4j.properties</code> file and then running <code><i>[dspace]</i>/bin/install-configs</code>.</TD>
      </TR>
      <TR>
        <TD><code><i>[tomcat]</i>/logs/catalina.out</code></TD>
        <TD>This is where Tomcat's standard output is written.  Many errors that occur within the Tomcat code are logged here.  For example, if Tomcat can't find the DSpace code (<code>dspace.jar</code>), it would be logged in <code>catalina.out</code>.</TD>
      </TR>
      <TR>
        <TD><code><i>[tomcat]</i>/logs/hostname_log.yyyy-mm-dd.txt</code></TD>
        <TD>If you're running Tomcat stand-alone (without Apache), it logs some information and errors for specific Web applications to this log file.  <code>hostname</code> will be your host name (e.g. <code>dspace.myu.edu</code>) and <code>yyyy-mm-dd</code> will be the date.</TD>
      </TR>
      <TR>
        <TD><code><i>[tomcat]</i>/logs/apache_log.yyyy-mm-dd.txt</code></TD>
        <TD>If you're using Apache, Tomcat logs information about Web applications running through Apache (<code>mod_webapp</code>) in this log file (<code>yyyy-mm-dd</code> being the date.)</TD>
      </TR>
      <TR>
        <TD><code><i>[apache]</i>/error_log</code></TD>
        <TD>Apache logs to this file.  If there is a problem with getting <code>mod_webapp</code> working, this is a good place to look for clues.  Apache also writes to several other log files, though <code>error_log</code> tends to contain the most useful information for tracking down problems.</TD>
      </TR>
      <TR>
        <TD><code><i>[dspace]</i>/log/handle-plug.log</code></TD>
        <TD>The Handle server runs as a separate process from the DSpace Web UI (which runs under Tomcat's JVM).  Due to a limitation of log4j's 'rolling file appenders', the DSpace code running in the Handle server's JVM must use a separate log file.  The DSpace code that is run as part of a Handle resolution request writes log information to this file.  You can control the verbosity of this by editing <code><i>[dspace]</i>/config/templates/log4j-handle-plugin.properties</code>.</TD>
      </TR>
      <TR>
        <TD><code><i>[dspace]</i>/log/handle-server.log</code></TD>
        <TD>This is the log file for CNRI's Handle server code.  If a problem occurs within the Handle server code, before DSpace's plug-in is invoked, this is where it may be logged.</TD>
      </TR>
      <TR>
        <TD><code><i>[dspace]</i>/handle-server/error.log</code></TD>
        <TD>On the other hand, a problem with CNRI's Handle server code might be logged here.</TD>
      </TR>
      <TR>
        <TD>PostgreSQL log</TD>
        <TD>PostgreSQL also writes a log file.  This one doesn't seem to have a default location, you probably had to specify it yourself at some point during installation.  In general, this log file rarely contains pertinent information--PostgreSQL is pretty stable, you're more likely to encounter problems with connecting via JDBC, and these problems will be logged in <code>dspace.log</code>.</TD>
      </TR>
    </TABLE>

    <HR>

    <ADDRESS>
      Copyright &copy; 2002-2004 MIT and Hewlett Packard
    </ADDRESS>
  </BODY>
</HTML>
