select bitstream.deleted, bitstream.store_number, bitstream.size_bytes, 
             bitstream.bitstream_id,  
             bitstream.user_format_description, bitstream.internal_id, 
             bitstream.source, bitstream.checksum_algorithm, bitstream.checksum, 
             bitstream.name, most_recent_checksum.last_process_end_date,
             most_recent_checksum.to_be_processed 
             from bitstream left outer join bitstreamformatregistry on bitstream.bitstream_format_id = bitstreamformatregistry.bitstream_format_id, 
             most_recent_checksum where bitstream.bitstream_id = XX  and bitstream.bitstream_id = most_recent_checksum.bitstream_id



select bitstream.deleted, 
             bitstream.size_bytes, 
             bitstream.bitstream_id,  
             bitstream.internal_id, 
             bitstream.source, 
             bitstream.checksum_algorithm, 
             bitstream.checksum, 
             most_recent_checksum.last_process_end_date,
             most_recent_checksum.to_be_processed 
             from bitstream left outer join bitstreamformatregistry on 
             bitstream.bitstream_format_id = 
             bitstreamformatregistry.bitstream_format_id,  
             most_recent_checksum where bitstream.bitstream_id = 1




SELECT bitstream.bitstream_id, bitstream.internal_id, checksum_history.process_end_date, checksum_history.result 
FROM bitstream LEFT JOIN checksum_history 
ON bitstream.bitstream_id = checksum_history.bitstream_id 
WHERE checksum_history.process_end_date <= '2014-01-28 16:30:27.431'


SELECT bitstream.bitstream_id, bitstream.internal_id, most_recent_checksum.last_process_end_date, checksum_history.process_end_date, checksum_history.result
FROM bitstream  
LEFT JOIN most_recent_checksum on bitstream.bitstream_id = most_recent_checksum.bitstream_id
JOIN checksum_history ON bitstream.bitstream_id = checksum_history.bitstream_id
WHERE checksum_history.result NOT LIKE 'CHECKSUM_MATCH'
ORDER BY most_recent_checksum.last_process_end_date DESC;
